########################################
# BreederHQ Environment Config Example #
########################################

# NOTE: .env.dev is already committed to the repo — it contains the AWS Secrets Manager
# pointer and non-secret local config. You do NOT need to copy this file for normal development.
#
# This file is reference documentation showing all available environment variables.
# Use it if you need to set up an environment WITHOUT AWS Secrets Manager
# (e.g., emergency rollback, CI runner, or new environment bootstrap).
#
# NOTE: .env.dev.migrate and .env.prod.migrate are thin SM config pointers — do NOT
#       add credentials to them. Add AWS_SECRET_NAME + AWS_PROFILE only.
#
# NeonDB Projects:
#   breederhq-prototype (legacy)  — active prototype (ep-misty-frog / ep-dark-breeze)
#   breederhq-production (prod)   — future production (ep-orange-smoke)
#   breederhq-development (dev)   — future dev/alpha/bravo (ep-odd-bonus / ep-twilight-sea / ep-young-river)
#
# AWS Secrets Manager naming (all in us-east-2):
#   Dev account (335274136775):
#     breederhq/dev-prototype  ← active dev (ep-misty-frog, breederhq-prototype)
#     breederhq/dev            ← future dev  (polished-fire-14346254)
#     breederhq/alpha          ← alpha env   (polished-fire-14346254)
#     breederhq/bravo          ← bravo env   (polished-fire-14346254)
#     breederhq/platform       ← cross-env management keys (NeonDB API, Sentry, etc.)
#   Prod account (427814061976):
#     breederhq/prod-prototype ← active prod (ep-dark-breeze, breederhq-prototype)
#     breederhq/prod           ← future prod (flat-flower-54202261)
#
# DB Role convention in every SM secret:
#   DATABASE_URL         = bhq_app @ pooler endpoint  (runtime)
#   DATABASE_DIRECT_URL  = bhq_migrator @ direct endpoint  (migrations + prisma db pull)
#
# In deployed environments, ALL secrets below are loaded from AWS Secrets Manager.
# Set USE_SECRETS_MANAGER=true and AWS_SECRET_NAME=breederhq/{env} to enable.
# See: docs/operations/AWS-SECRETS-MANAGER.md

# Runtime: Use pooled connection (-pooler endpoint, via PgBouncer)
# DATABASE_URL=postgresql://neondb_owner:PASSWORD@HOST-pooler.c-3.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require

# Migrations: Use direct connection (no pooler, for DDL operations)
# DATABASE_URL=postgresql://neondb_owner:PASSWORD@HOST.c-3.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require
# DATABASE_DIRECT_URL=postgresql://neondb_owner:PASSWORD@HOST.c-3.us-east-2.aws.neon.tech/neondb?sslmode=require&channel_binding=require

NODE_ENV=development
PORT=6001

# Session cookie signing (REQUIRED, min 32 chars)
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('base64'))"
COOKIE_SECRET=

# Database connection (pooled for runtime, direct for migrations)
DATABASE_URL=
DATABASE_DIRECT_URL=

# ────────────────────────────────────────────────────────────────────────────
# Email (Resend)
# ────────────────────────────────────────────────────────────────────────────
# Get your API key from https://resend.com/api-keys
RESEND_API_KEY=

# From address (must be verified domain in Resend for production)
# Development: Use Resend's test domain: onboarding@resend.dev
# Production: Use your verified domain: noreply@mail.breederhq.com
RESEND_FROM_EMAIL=onboarding@resend.dev
RESEND_FROM_NAME=BreederHQ

# Inbound email configuration
# Domain for receiving emails (must match Resend verified domain)
RESEND_INBOUND_DOMAIN=mail.breederhq.com
# Webhook signing secret (from Resend webhook setup)
RESEND_WEBHOOK_SECRET=
# HMAC secret for signing reply-to addresses (generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
INBOUND_EMAIL_HMAC_SECRET=

# ────────────────────────────────────────────────────────────────────────────
# Email Development Safeguards
# ────────────────────────────────────────────────────────────────────────────
# These settings ONLY apply when NODE_ENV != "production"
# They prevent accidentally emailing real users during development.

# Option 1: Redirect all emails to a single test address
# All emails will be sent here with "[DEV: original@email.com]" in subject
# EMAIL_DEV_REDIRECT=your-dev-email@gmail.com

# Option 2: Log only mode - emails are logged but never sent
# Set to "true" to enable (useful for local testing without Resend)
# EMAIL_DEV_LOG_ONLY=true

# Option 3: Allow specific domains through (comma-separated)
# Emails to these domains will be sent normally, others will be redirected/blocked
# EMAIL_DEV_ALLOWED_DOMAINS=yourdomain.com,test.breederhq.com

# ────────────────────────────────────────────────────────────────────────────
# Application URLs
# ────────────────────────────────────────────────────────────────────────────
# Used in email templates for links back to the app
APP_URL=http://localhost:5173

# Stripe Billing
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=

# ────────────────────────────────────────────────────────────────────────────
# AWS S3 Storage & CDN
# ────────────────────────────────────────────────────────────────────────────
# Used for file uploads (animal photos, documents, contracts, etc.)
# DEV bucket: breederhq-assets-dev
# PROD bucket: breederhq-assets-prod
AWS_ACCESS_KEY_ID=
AWS_SECRET_ACCESS_KEY=
AWS_REGION=us-east-1
S3_BUCKET=breederhq-assets-dev

# CloudFront CDN domain (REQUIRED — without this, image URLs fall back to
# direct S3 URLs which return 403 because the bucket only allows CloudFront OAC).
# See docs/operations/infrastructure/AWS-ENVIRONMENT-INVENTORY.md for per-env values.
# In deployed environments, this is loaded from AWS Secrets Manager.
CDN_DOMAIN=d15tdn3qa9of1k.cloudfront.net

# ────────────────────────────────────────────────────────────────────────────
# Mobile App Authentication (JWT)
# ────────────────────────────────────────────────────────────────────────────
# Required for mobile app (native iOS/Android) authentication.
# Access tokens expire in 1 hour, refresh tokens in 30 days.
# Generate secrets with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_ACCESS_SECRET=
JWT_REFRESH_SECRET=

# ────────────────────────────────────────────────────────────────────────────
# Email Compliance (CAN-SPAM / List-Unsubscribe)
# ────────────────────────────────────────────────────────────────────────────
# Secret for signing unsubscribe tokens (JWT). Separate from auth secrets.
# Unsubscribe headers are omitted if not set (emails still send without them).
# Generate with: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"
JWT_UNSUBSCRIBE_SECRET=

# ────────────────────────────────────────────────────────────────────────────
# Firebase Cloud Messaging (Push Notifications)
# ────────────────────────────────────────────────────────────────────────────
# Optional - push notifications are disabled if not configured.
# Get credentials from Firebase Console → Project Settings → Service Accounts → Generate New Private Key
FIREBASE_PROJECT_ID=
FIREBASE_CLIENT_EMAIL=
# Note: The private key should include the "-----BEGIN PRIVATE KEY-----" header/footer.
# In shell, escape newlines: FIREBASE_PRIVATE_KEY="-----BEGIN PRIVATE KEY-----\n...\n-----END PRIVATE KEY-----\n"
FIREBASE_PRIVATE_KEY=

# ────────────────────────────────────────────────────────────────────────────
# Redis (Horizontal Scaling)
# ────────────────────────────────────────────────────────────────────────────
# Optional - enables shared state across multiple API instances:
# - Rate limiting enforced across all instances
# - WebSocket pub/sub (real-time messages reach users on any instance)
# - Geocoding cache shared (reduces external API calls)
# If not set, falls back to in-memory stores (single instance only).
# REDIS_URL=redis://localhost:6379
# REDIS_URL=redis://user:password@host:6379

# ────────────────────────────────────────────────────────────────────────────
# Background Jobs
# ────────────────────────────────────────────────────────────────────────────
# Network Search Index rebuild — daily aggregation of traits for privacy-preserving search
# Cron format: "minute hour day month weekday" (default: 4:00 AM daily)
# NETWORK_SEARCH_INDEX_CRON="0 4 * * *"
# Set to "false" to disable the job
# NETWORK_SEARCH_INDEX_ENABLED=true

# Animal Access Cleanup — hard-deletes OWNER_DELETED records after retention period
# Cron format: "minute hour day month weekday" (default: 3:00 AM daily)
# ANIMAL_ACCESS_CLEANUP_CRON="0 3 * * *"
# Set to "false" to disable the job
# ANIMAL_ACCESS_CLEANUP_ENABLED=true
# Days to retain OWNER_DELETED records before permanent deletion (default: 30)
# ANIMAL_ACCESS_CLEANUP_RETENTION_DAYS=30
